"use strict";var Focus=function(e,t){var s=t||{};if(this.settings=Object.assign({visibleClass:"visible",bodyClass:"active-popup",triggerClass:null,detach:null,innerSelector:".popup-inner",autoFocusSelector:"[data-auto-focus]",slide:null,slideSpeed:200,visible:!1,showCallback:null,hideCallback:null,error:null},s),this.visible=this.settings.visible,this.element=document.querySelector(e),this.innerElement=document.querySelector(e+" "+this.settings.innerSelector),this.closeElement=document.querySelector(e+" [data-close]"),this.target=e,this.settings.slide){var i=this.element.style.display;this.element.style.display="block",this.maxHeight=this.element.offsetHeight,this.element.style.display=i,this.height=this.element.offsetHeight,this.counter=this.height}this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.toggle=this.toggle.bind(this),this.detach=this.detach.bind(this),this.slideDown=this.slideDown.bind(this),this.slideUp=this.slideUp.bind(this),this.boundCloseEvent=Focus.closeEvent.bind(this),this.boundEscListener=Focus.escEvent.bind(this),this.settings.detach&&document.addEventListener("DOMContentLoaded",this.detach),Focus.elements[e]=this};Focus.elements={},Focus.getTarget=function(e){var t=e.target;return"A"===t.tagName&&e.preventDefault(),t.dataset.target||null},Focus.eventHandler=function(e,t,s){e.preventDefault();var i=Focus.elements[t];return i||(i=new Focus(t)),"hide"===s?i.hide():i.toggle()},Focus.closeEvent=function(e){if(e.currentTarget===e.target){e.preventDefault();var t=Focus.getTarget(e);t?Focus.eventHandler(e,t,"hide"):this.hide()}},Focus.escEvent=function(e){27===e.keyCode&&(this.element.removeEventListener("keyup",Focus.escEvent),this.hide())},Focus.buildEventListeners=function(){for(var e=document.querySelectorAll("[data-trigger]"),t=function(t){var s=e[t].dataset.target;e[t].addEventListener("click",function(e){Focus.eventHandler(e,s)})},s=0;s<e.length;s+=1)t(s)},Focus.addClass=function(e,t){var s=e;s.classList&&s.classList.add(t)},Focus.removeClass=function(e,t){var s=e;s.classList&&s.classList.remove(t)},Focus.prototype.slideDown=function(){var e=this,t=this.element,s=this.element.style.display;t.style.display="block",t.style.overflow="visible",t.style.maxHeight="100%",this.maxHeight=t.offsetHeight,t.style.display=s,this.height=t.offsetHeight,this.counter=this.height,t.style.maxHeight=this.height+"px",t.style.overflow="hidden",t.style.display="block";var i=this.maxHeight/100;this.interval=setInterval(function(){e.counter+=i,e.counter<e.maxHeight?t.style.maxHeight=e.counter+"px":(t.style.maxHeight=null,t.style.overflow=null,e.height=e.element.offsetHeight,clearInterval(e.interval))},this.settings.slideSpeed/100)},Focus.prototype.slideUp=function(){var e=this,t=this.element,s=this.maxHeight/100;t.style.overflow="hidden",this.interval=setInterval(function(){e.counter-=s,e.counter>0?t.style.maxHeight=e.counter+"px":(t.style.maxHeight=null,t.style.display="none",t.style.overflow=null,clearInterval(e.interval))},this.settings.slideSpeed/100)},Focus.prototype.show=function(){if(this.visible&&this.element.classList.contains(this.settings.visibleClass))this.settings.error&&"function"==typeof this.settings.error&&this.settings.error("Focus: Error this element is already visible",this);else{if(this.settings.triggerClass){var e=document.querySelector('[data-target="'+this.target+'"]');Focus.addClass(e,this.settings.triggerClass)}this.settings.slide&&this.slideDown(this.settings.slideDuration),Focus.addClass(this.element,this.settings.visibleClass),Focus.addClass(document.body,this.settings.bodyClass),this.visible=!0;var t=document.querySelector(this.target+" "+this.settings.autoFocusSelector);t&&setTimeout(function(){t.focus()},300),this.closeElement&&(this.closeElement.removeEventListener("click",this.boundCloseEvent),this.closeElement.addEventListener("click",this.boundCloseEvent)),this.innerElement&&(this.innerElement.removeEventListener("click",this.boundCloseEvent),this.innerElement.addEventListener("click",this.boundCloseEvent)),this.element.removeEventListener("keyup",this.boundEscListener),this.element.addEventListener("keyup",this.boundEscListener),this.settings.showCallback&&"function"==typeof this.settings.showCallback&&this.settings.showCallback(this)}return this},Focus.prototype.hide=function(){if(this.visible||this.element.classList.contains(this.settings.visibleClass)){if(Focus.removeClass(this.element,this.settings.visibleClass),this.settings.triggerClass){var e=document.querySelector('[data-target="'+this.target+'"]');Focus.removeClass(e,this.settings.triggerClass)}this.settings.slide&&this.slideUp(this.settings.slideDuration),Focus.removeClass(document.body,this.settings.bodyClass),this.closeElement&&this.closeElement.removeEventListener("click",Focus.closeEvent),this.innerElement&&this.innerElement.removeEventListener("click",Focus.closeEvent),this.visible=!1,this.settings.hideCallback&&"function"==typeof this.settings.hideCallback&&this.settings.hideCallback(this)}else this.settings.error&&"function"==typeof this.settings.error&&this.settings.error("Focus: Error this element is already hidden",this);return this},Focus.prototype.toggle=function(){return this.visible?this.hide():this.show(),this},Focus.prototype.detach=function(){return document.body.appendChild(this.element),this},document.addEventListener("DOMContentLoaded",Focus.buildEventListeners);